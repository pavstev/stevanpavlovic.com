# yaml-language-server: $schema=https://json.schemastore.org/lefthook.json
$schema: https://json.schemastore.org/lefthook.json
min_version: 1.12.3
assert_lefthook_installed: true
rc: ./.lefthookrc

output:
  - failure

templates:
  just: pnpm just
  nx: pnpm nx run
  nx_many: pnpm nx run-many

pre-commit:
  only:
    - { ref: release }
  parallel: true
  commands:
    all:
      run: pnpm run repokit all

pre-push:
  only:
    - { ref: release }
  commands:
    all:
      run: pnpm run repokit all

prepare-commit-msg:
  only:
    - { ref: release }
  commands:
    commitzen:
      interactive: true
      run: pnpm cz --hook
      env:
        LEFTHOOK: "0"

commit-msg:
  only:
    - { ref: release }
  commands:
    lint-commit-message:
      run: pnpm commitlint --edit {1}
    all:
      run: pnpm run repokit all
