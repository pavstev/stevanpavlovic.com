---
import type { HTMLAttributes } from "astro/types";

import { cva, type VariantProps } from "class-variance-authority";

import AppIcon, { type Props as AppIconProps } from "./app-icon.astro";

const variants = cva("flex items-center justify-center rounded-xl transition-colors duration-200", {
  defaultVariants: {
    size: "md",
    variant: "default",
  },
  variants: {
    size: {
      lg: "size-12 rounded-xl",
      md: "size-10 rounded-xl",
      sm: "size-8 rounded-lg",
      xl: "size-16 rounded-xl",
    },
    variant: {
      default: "border border-border bg-muted/30 text-muted-foreground",
      ghost: "border-transparent bg-transparent text-muted-foreground hover:text-foreground",
      outline: "border border-border bg-transparent text-foreground",
      primary: "border border-primary bg-primary text-primary-foreground",
    },
  },
});

interface Props extends HTMLAttributes<"div">, Omit<VariantProps<typeof variants>, "size"> {
  as?: string;
  /** Name of the icon to render */
  icon?: string;
  /** Act/State for the icon */
  iconAct?: AppIconProps["act"];
  /** Class for the icon */
  iconClass?: string;
  /** Group hover effect for the icon */
  iconHover?: AppIconProps["hover"];
  /** Size for the icon */
  iconSize?: AppIconProps["size"];
  /** Tone for the icon */
  iconTone?: AppIconProps["tone"];
  /** Transition effect for the icon */
  iconTransition?: AppIconProps["transition"];
  size?: "lg" | "md" | "sm" | "xl" | number;
}

const {
  as: Tag = "div",
  class: className,
  icon,
  iconAct,
  iconClass,
  iconHover,
  iconSize,
  iconTone,
  iconTransition,
  size = "md",
  variant,
  ...props
} = Astro.props;

const isNumericSize = typeof size === "number";
const numericStyle = isNumericSize ? { height: `${size}px`, width: `${size}px` } : {};
---

<Tag
  class:list={variants({ className, size: isNumericSize ? null : (size as any), variant })}
  style={numericStyle}
  {...props}
>
  {
    icon ? (
      <AppIcon
        act={iconAct}
        class:list={[iconClass]}
        hover={iconHover}
        name={icon}
        size={iconSize}
        tone={iconTone}
        transition={iconTransition}
      />
    ) : (
      <slot />
    )
  }
</Tag>
