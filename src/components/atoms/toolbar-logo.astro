---
import type { ImageMetadata } from "astro";

import { Image } from "astro:assets";
import { cva, type VariantProps } from "class-variance-authority";

const variants = cva("relative shrink-0 overflow-hidden leading-none transition-all duration-300", {
  defaultVariants: {
    size: "md",
    type: "organization",
  },
  variants: {
    size: {
      lg: "size-10",
      md: "size-8",
      sm: "size-6",
    },
    type: {
      organization:
        "flex items-center justify-center rounded-lg border border-border/50 bg-background/50 p-1.5 shadow-sm ring-1 ring-border/5 backdrop-blur-md",
      person:
        "rounded-full border border-border/80 bg-background/50 shadow-sm ring-2 ring-background/50 backdrop-blur-md",
      status: "flex items-center justify-center",
    },
  },
});

interface Props extends VariantProps<typeof variants> {
  alt?: string;
  src?: ImageMetadata;
}

const { alt, size, src, type } = Astro.props;
---

<div class:list={[variants({ size, type })]}>
  {
    type === "status" ? (
      <span class="relative flex size-2.5">
        <span class="absolute inline-flex size-full animate-ping rounded-full bg-accent opacity-75" />
        <span class="shadow-glow-accent relative inline-flex size-2.5 rounded-full bg-accent" />
      </span>
    ) : (
      src && (
        <Image
          alt={alt || ""}
          class:list={[
            "size-full transition-all duration-500",
            {
              "object-contain opacity-80 group-hover:scale-105 group-hover:opacity-100":
                type === "organization" || !type,
              "object-cover": type === "person",
            },
          ]}
          src={src}
        />
      )
    )
  }
</div>
