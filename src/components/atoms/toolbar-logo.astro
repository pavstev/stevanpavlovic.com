---
import type { ImageMetadata } from "astro";

import { Image } from "astro:assets";
import { cva, type VariantProps } from "class-variance-authority";

const variants = cva("relative shrink-0 overflow-hidden leading-none transition-all duration-300", {
  defaultVariants: {
    size: "md",
    type: "organization",
  },
  variants: {
    size: {
      lg: "size-9",
      md: "size-7.5",
      sm: "size-5",
    },
    type: {
      organization:
        "flex items-center justify-center rounded-md border border-white/5 bg-white/5 p-1 shadow-sm ring-1 ring-white/10 backdrop-blur-xl group-hover:border-primary/30 group-hover:bg-primary/5",
      person:
        "rounded-full border border-white/10 bg-white/5 shadow-sm ring-2 ring-white/10 backdrop-blur-xl group-hover:border-primary/30",
      status: "flex items-center justify-center",
    },
  },
});

interface Props extends VariantProps<typeof variants> {
  alt?: string;
  src?: ImageMetadata;
}

const { alt, size, src, type } = Astro.props;
---

<div class:list={[variants({ size, type })]}>
  {
    type === "status" ? (
      <span class="relative flex size-2.5">
        <span class="absolute inline-flex size-full animate-ping rounded-full bg-accent opacity-75" />
        <span class="shadow-glow-accent relative inline-flex size-2.5 rounded-full bg-accent" />
      </span>
    ) : (
      src && (
        <Image
          alt={alt || ""}
          class:list={[
            "size-full transition-all duration-500",
            {
              "object-contain opacity-80 group-hover:scale-105 group-hover:opacity-100":
                type === "organization" || !type,
              "object-cover": type === "person",
            },
          ]}
          src={src}
        />
      )
    )
  }
</div>
