---
const id = import.meta.env.PUBLIC_GTM_ID;
---

<script is:inline src={`https://www.googletagmanager.com/gtag/js?id=${id}`} type="text/partytown"></script>

<script define:vars={{ id }} is:inline type="text/partytown">
  window.dataLayer = window.dataLayer || [];
  window.gtag = function () {
    window.dataLayer.push(arguments);
  };
  window.gtag("js", new Date());
  window.gtag("config", id);
</script>

<script>
  import { trackPageView } from '../lib/gtm';

  document.addEventListener("astro:after-navigation", () => {
    trackPageView(window.location.pathname);
  });
</script>
