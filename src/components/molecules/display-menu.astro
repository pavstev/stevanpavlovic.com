---
import { VIEW_MODES } from "../../config";
import { buildListUrl, type DisplayMode, type ViewUrls } from "../../lib";
import Button from "../atoms/Button.astro";
import Icon from "../atoms/Icon.astro";

interface Props {
  display?: DisplayMode;
  displayUrls?: ViewUrls;
  showLabels?: boolean;
}

const { display = "list", displayUrls, showLabels = true } = Astro.props;

const buildUrl = (path: string, paramsToSet: Record<string, number | string | undefined> = {}) =>
  buildListUrl(Astro.url, "path", path, paramsToSet);
---

<div class="display-menu glass relative flex items-center gap-1.5 rounded-2xl p-1.5 shadow-2xl">
  {
    VIEW_MODES.map(({ icon, label, mode }) => {
      const isActive = display === mode;
      return (
        <Button
          as="a"
          class:list={[
            "relative min-h-9 overflow-hidden transition-all duration-300 hover:no-underline",
            { "shadow-glow-primary bg-primary text-primary-foreground": isActive },
          ]}
          data-active={isActive}
          href={displayUrls ? buildUrl(displayUrls[mode]) : buildUrl(Astro.url.pathname, { mode })}
          size="sm"
          variant={isActive ? "primary" : "ghost"}
        >
          <Icon class:list={{ "transition-colors group-hover:text-primary": !isActive }} name={icon} size="md" />
          {showLabels && <span class="ml-2 font-mono text-[12px] font-bold tracking-wider uppercase">{label}</span>}
        </Button>
      );
    })
  }
</div>
