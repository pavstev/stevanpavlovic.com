---
import { Icon } from 'astro-icon/components';

interface DropdownItem {
  active: boolean;
  href: string;
  label: string;
}

interface Props {
  icon?: string;
  items: DropdownItem[];
  label: string;
  mobileFullWidth?: boolean;
}

const { icon, items, label, mobileFullWidth = false } = Astro.props;
---

<div class="relative z-50 w-full md:w-auto" data-dropdown>
  <button
    aria-expanded="false"
    aria-haspopup="true"
    class:list={[
      "group flex w-full items-center justify-between gap-2 rounded-lg border border-border bg-background/50 px-4 py-2.5 text-sm font-medium text-foreground/80 transition-all hover:border-accent hover:bg-accent hover:text-foreground",
      {"md:min-w-[180px]": !mobileFullWidth, "md:min-w-[220px]": mobileFullWidth}
    ]}
    data-trigger
    type="button"
  >
    <span class="flex items-center gap-2 truncate">
      {icon && <Icon class="text-muted-foreground transition-colors group-hover:text-muted-foreground/80" name={icon} size={16} />}
      {label}
    </span>
    <Icon class="text-muted-foreground transition-transform duration-300 group-hover:text-muted-foreground/80" data-chevron name="mdi:chevron-down" size={18} />
  </button>

  <div
    class:list={[
      "absolute top-full left-0 mt-2 hidden w-full origin-top scale-95 transform flex-col overflow-hidden rounded-xl border border-border bg-background/95 p-1.5 opacity-0 shadow-xl backdrop-blur-xl transition-all duration-200 ease-out md:w-auto",
      {"min-w-[180px]": !mobileFullWidth, "min-w-[240px]": mobileFullWidth}
    ]}
    data-menu
  >
    <div class="custom-scrollbar max-h-[320px] overflow-y-auto pr-1">
      {
        items.map((item) => (
          <a
            class:list={[
              "mb-0.5 flex items-center justify-between rounded-lg px-3 py-2.5 text-sm transition-all",
              {"bg-primary/10 font-medium text-primary": item.active, "text-muted-foreground hover:bg-accent hover:text-foreground": !item.active}
            ]}
            href={item.href}
          >
            <span>{item.label}</span>
            {item.active && <Icon name="mdi:check" size={16} />}
          </a>
        ))
      }
    </div>
  </div>
</div>
