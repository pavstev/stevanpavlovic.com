---
import { type Tag, type ToolbarItem, type ViewPagePropsTags } from "../../lib/collection-pages";
import ToolbarItemComponent from "../atoms/toolbar-item.astro";
import ToolbarLogo from "../atoms/toolbar-logo.astro";
import PostDescription from "./post-description.astro";
import PostTags from "./post-tags.astro";

interface Props {
  description?: string;
  tags: undefined | ViewPagePropsTags;
  toolbarItems: (ToolbarItem | undefined)[];
}

const {
  description,
  tags = {
    items: [] as Tag[],
    title: undefined,
  },
  toolbarItems = [],
} = Astro.props;

const items = toolbarItems.filter((i): i is ToolbarItem => !!i);
---

<div class="flex flex-col gap-4 border-t-2 border-foreground/30 bg-foreground/5 px-6 py-4">
  {/* Top row: Items left, Tags/Description right */}
  <div class="grid grow-0 grid-cols-1 items-start gap-4 md:grid-cols-2">
    <PostDescription description={description} />
    <div class="flex flex-col gap-1">
      <div class="grid grid-cols-3">
        {
          items.map((item) => (
            <ToolbarItemComponent label={item.label}>
              <div class="flex items-center gap-2">
                {item.href ? (
                  <a
                    class="flex items-center gap-2.5 transition-colors outline-none hover:text-primary focus-visible:text-primary"
                    href={item.href}
                    target="_blank"
                  >
                    {item.logo && <ToolbarLogo alt={item.value} size="md" src={item.logo} />}
                    <span>{item.value}</span>
                  </a>
                ) : (
                  <div class="flex items-center gap-2.5">
                    {item.logo && <ToolbarLogo alt={item.value} size="md" src={item.logo} />}
                    <span>{item.value}</span>
                  </div>
                )}
              </div>
            </ToolbarItemComponent>
          ))
        }
      </div>
      <PostTags tags={tags.items} title={tags.title} />
    </div>
  </div>
</div>
