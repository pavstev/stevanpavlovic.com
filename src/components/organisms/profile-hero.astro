---
import profileImage from '../../assets/profile.jpeg';
import { cn } from '../../lib/cn';
import { PROFILE, SITE_CONFIG } from '../../lib/config';
import Stack from '../atoms/stack.astro';
import Text from '../atoms/text.astro';
import ZoomableImage from '../molecules/zoomable-image.astro';
import { Icon } from 'astro-icon/components';

interface Props {
  class?: string;
}

const { class: className } = Astro.props;

// New utility function for formatting numbers nicely
// e.g. 1200 -> 1.2k, 1000000 -> 1M
const formatCompactNumber = (number: number) => {
  const formatter = new Intl.NumberFormat('en-US', {
    notation: "compact",
    compactDisplay: "short",
    maximumFractionDigits: 1,
  });
  return formatter.format(number);
};

// Updated stats with exact number values and improved icon choices
const stats = [
  { value: 12, label: 'Years Experience', icon: 'mdi:clock-time-eight-outline' },
  { value: 24, label: 'Systems Architected', icon: 'mdi:server-network' },
  { value: 120000, label: 'Users Served', icon: 'mdi:account-group-outline' },
];
---

<div class:list={cn("flex flex-col items-center gap-8 text-center md:flex-row-reverse md:items-start md:text-left", className)}>
  {/* Avatar - photo card popping effect */}
  <div class="relative flex shrink-0 items-center justify-center p-4">
    <div class="group relative size-40 md:size-48">
      {/* Decorative backing card (adds depth) */}
      <div class="absolute inset-0 rotate-6 rounded-xl bg-white/10 shadow-lg backdrop-blur-sm transition-transform duration-500 ease-in-out group-hover:rotate-12 group-hover:scale-105"></div>

      {/* Main Photo Card */}
      <div class="relative h-full w-full -rotate-3 overflow-hidden rounded-xl border-4 border-white/90 bg-white shadow-2xl transition-all duration-500 ease-in-out group-hover:rotate-2 group-hover:scale-110 group-hover:shadow-[0_0_40px_rgba(255,255,255,0.4)]">
        <ZoomableImage
          alt={PROFILE.name}
          class="h-full w-full object-cover"
          loading="eager"
          src={profileImage}
        />
        {/* Gloss overlay */}
        <div class="pointer-events-none absolute inset-0 bg-gradient-to-tr from-white/20 to-transparent opacity-50"></div>
      </div>
    </div>
  </div>

  {/* Content */}
  <Stack align="start" class="flex flex-1 items-center" gap={0}>
    <div class="flex-1">
      {/* Heading */}
      <h1 class="text-left font-heading text-4xl font-bold tracking-tight md:text-5xl lg:text-6xl">
        <span class="font-mono text-sm tracking-[0.2em] text-white/80 md:text-base">Hi, I'm</span><br />
        <span class="hero-title animate-shiny-text relative mt-3 inline-block text-white">
          {SITE_CONFIG.hero.title.main} {SITE_CONFIG.hero.title.highlight}
        </span><br />
        <span class="mt-3 inline-block font-mono text-sm tracking-[0.2em] text-white/80 md:text-base">
          {SITE_CONFIG.hero.tagline}
        </span>
      </h1>

      {/* Statistics */}
      <div class="flex flex-wrap justify-start gap-6 py-6 md:gap-10">
        {stats.map((stat) => (
          <div class="group flex items-center gap-3">
            {/* Icon Container */}
            <div class="flex items-center justify-center rounded-lg bg-white/10 p-2 text-white ring-1 ring-white/20 backdrop-blur-md transition-colors group-hover:bg-white/20 group-hover:text-white">
              <Icon class="size-6 md:size-7" name={stat.icon} />
            </div>

            {/* Text Content */}
            <div class="flex flex-col text-left">
              <Text class="text-xl font-bold leading-none text-white md:text-2xl" variant="primary">
                {formatCompactNumber(stat.value)}+
              </Text>
              <Text class="mt-1 text-xs font-medium uppercase tracking-wide text-white/60" variant="primary">
                {stat.label}
              </Text>
            </div>
          </div>
        ))}
      </div>
    </div>
  </Stack>
</div>
