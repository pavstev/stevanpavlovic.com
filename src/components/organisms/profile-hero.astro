---
import profileImage from '../../assets/profile.jpeg';
import { cn } from '../../lib/cn';
import { PROFILE, SITE_CONFIG } from '../../lib/config';
import Heading from '../atoms/heading.astro';
import Stack from '../atoms/stack.astro';
import Text from '../atoms/text.astro';
import Stat from '../molecules/stat.astro';
import ZoomableImage from '../molecules/zoomable-image.astro';

interface Props {
  class?: string;
}

const { class: className } = Astro.props;

// New utility function for formatting numbers nicely
const formatCompactNumber = (number: number) => {
  const formatter = new Intl.NumberFormat('en-US', {
    compactDisplay: "short",
    maximumFractionDigits: 1,
    notation: "compact",
  });
  return formatter.format(number);
};

// Expanded stats for a more professional overview
const stats = [
  { icon: 'mdi:clock-time-eight-outline', label: 'Years Exp.', value: 12 },
  { icon: 'mdi:server-network', label: 'Systems', value: 24 },
  { icon: 'mdi:account-group-outline', label: 'Users', value: 120000 },
  { icon: 'mdi:earth', label: 'Countries', value: 15 },
  { icon: 'mdi:check-decagram-outline', label: 'Uptime', value: "99.9%" },
];
---

<div class:list={cn("grid grid-cols-1 items-center gap-8 md:grid-cols-[1fr_auto] md:items-start", className)}>
  {/* Content */}
  <Stack align="start" class="order-2 md:order-1" gap={6}>
    <div class="space-y-1">
      <Text class="max-w-xl font-mono tracking-tight text-white/50" size="lg">
        Hi, I'm
      </Text>
      <Heading class="leading-[1.1]" size="display">
        <span class="animate-shiny-text block">
          {SITE_CONFIG.hero.title.main} {SITE_CONFIG.hero.title.highlight}
        </span>
      </Heading>
      <Text class="max-w-xl font-mono tracking-tight text-white/50" size="lg">
        {SITE_CONFIG.hero.tagline}
      </Text>

      {/* Statistics */}
      <div class="flex flex-wrap justify-start gap-4 pt-8 md:gap-8">
        {stats.map((stat) => (
          <Stat
            class="origin-left scale-90 md:scale-100"
            icon={stat.icon}
            label={stat.label}
            value={typeof stat.value === 'number' ? `${formatCompactNumber(stat.value)}+` : stat.value}
          />
        ))}
      </div>
    </div>
  </Stack>

  {/* Avatar Section */}
  <div class="order-1 flex justify-center md:order-2 md:justify-end">
    <div class="group relative">
      {/* Glow Backdrop */}
      <div class="absolute -inset-4 bg-primary/20 opacity-0 blur-3xl transition-opacity duration-500 group-hover:opacity-100"></div>

      {/* Image Container */}
      <div class="glass relative overflow-hidden rounded-2xl border border-white/10 shadow-2xl transition-all duration-500 group-hover:scale-[1.02] group-hover:border-primary/30 group-hover:shadow-primary/10">
        <div class="aspect-4/5 w-48 md:w-56">
          <ZoomableImage
            alt={PROFILE.name}
            class="size-full object-cover transition-transform duration-700 group-hover:scale-110"
            loading="eager"
            src={profileImage}
          />
        </div>

        {/* Animated Accent line */}
        <div class="absolute bottom-0 left-0 h-1 w-0 bg-primary/50 transition-all duration-500 group-hover:w-full"></div>
      </div>
    </div>
  </div>
</div>
