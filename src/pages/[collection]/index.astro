---
// Handles: /blog, /projects, /experience (defaults to list display, page 1)
import type { GetStaticPaths } from "astro";
import type { CollectionKey } from "astro:content";

import CollectionPage from "../../components/templates/collection-page.astro";
import { getCollectionPageData } from "../../lib";

export const prerender = true;

export interface Params {
  collection: CollectionKey;
}

export const getStaticPaths: GetStaticPaths = async () => {
  const collections: CollectionKey[] = ["blog", "projects", "experience"];

  return collections.map((collection) => ({
    params: { collection },
  }));
};

const { collection } = Astro.params as unknown as Params;
const pageData = await getCollectionPageData(collection, 1, "list");

const {
  baseUrl,
  collectionItems,
  config,
  containerId,
  currentPage,
  display,
  displayUrls,
  getItemCardProps,
  initialPageSize,
  nextUrl,
  prevUrl,
  totalItems,
  totalPages,
} = pageData;
---

<CollectionPage
  {...config}
  baseUrl={baseUrl}
  collectionItems={collectionItems}
  collectionKey={collection}
  containerId={containerId}
  currentPage={currentPage}
  display={display}
  displayUrls={displayUrls}
  getItemCardProps={getItemCardProps}
  initialPageSize={initialPageSize}
  nextUrl={nextUrl}
  prevUrl={prevUrl}
  totalItems={totalItems}
  totalPages={totalPages}
/>
