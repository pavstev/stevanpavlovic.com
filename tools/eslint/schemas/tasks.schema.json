{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "additionalProperties": false,
  "description": "Unified Configuration schema for Repokit task runner.",
  "properties": {
    "vars": {
      "type": "object",
      "description": "Global variables for command and path interpolation.",
      "additionalProperties": { "type": "string" }
    },
    "tasks": {
      "type": "object",
      "description": "Task definitions (Atomic or Pipeline).",
      "patternProperties": {
        "^[a-z0-9_\\-]+$": {
          "type": "object",
          "required": ["name", "type", "pre_msg", "on_error"],
          "additionalProperties": false,
          "properties": {
            "name": { "type": "string" },
            "type": { "enum": ["single", "batch"], "description": "Single command or a list of child tasks." },
            "description": { "type": "string" },
            "pre_msg": { "type": "string", "description": "Status message shown before execution starts." },
            "on_error": { "type": "string", "description": "Message shown if the task fails." },
            "command": { "type": "string", "description": "Required if type is 'single'." },
            "tasks": { "type": "array", "items": { "type": "string" }, "description": "Required if type is 'batch'." },
            "cwd": { "type": "string" },
            "pre_run": { "type": "array", "items": { "type": "string" } },
            "post_run": { "type": "array", "items": { "type": "string" } },
            "parallel": { "type": "boolean", "default": false },
            "workers": { "type": "integer", "default": 3 },
            "interactive": { "type": "boolean", "default": false }
          }
        }
      }
    }
  },
  "required": ["tasks"],
  "title": "Repokit Task Configuration",
  "type": "object"
}
