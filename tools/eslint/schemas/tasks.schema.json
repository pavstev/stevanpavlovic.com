{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "additionalProperties": false,
  "description": "Configuration schema for the Repokit task runner and project orchestrator.",
  "properties": {
    "vars": {
      "type": "object",
      "description": "Global variables for command and path interpolation using ${var} syntax.",
      "additionalProperties": { "type": "string" }
    },
    "tasks": {
      "type": "object",
      "description": "Atomic task definitions.",
      "patternProperties": {
        "^[a-z0-9_\\-]+$": {
          "type": "object",
          "required": ["name", "command"],
          "additionalProperties": false,
          "properties": {
            "name": {
              "type": "string",
              "description": "Display name of the task."
            },
            "description": {
              "type": "string",
              "description": "Short description for the help menu."
            },
            "command": {
              "type": "string",
              "description": "The shell command to execute."
            },
            "cwd": {
              "type": "string",
              "description": "Working directory (defaults to project root)."
            },
            "pre_run": {
              "type": "array",
              "description": "List of task IDs to run before this task.",
              "items": { "type": "string" }
            },
            "post_run": {
              "type": "array",
              "description": "List of task IDs to run after this task.",
              "items": { "type": "string" }
            },
            "interactive": {
              "type": "boolean",
              "description": "Whether to run with a TTY (direct stdin/out).",
              "default": false
            }
          }
        }
      }
    },
    "batches": {
      "type": "object",
      "description": "Grouped tasks that are exposed as top-level CLI commands.",
      "patternProperties": {
        "^[a-z0-9_\\-]+$": {
          "type": "object",
          "required": ["name", "tasks"],
          "additionalProperties": false,
          "properties": {
            "name": {
              "type": "string",
              "description": "Display name for the batch pipeline."
            },
            "description": {
              "type": "string",
              "description": "Command line help text."
            },
            "tasks": {
              "type": "array",
              "description": "List of atomic task IDs to execute in this batch.",
              "items": { "type": "string" }
            },
            "parallel": {
              "type": "boolean",
              "description": "Execute tasks in parallel using the queue worker.",
              "default": false
            },
            "workers": {
              "type": "integer",
              "description": "Number of concurrent workers if parallel is true.",
              "default": 3
            },
            "continue_on_error": {
              "type": "boolean",
              "description": "Whether to keep running other tasks if one fails.",
              "default": false
            }
          }
        }
      }
    }
  },
  "required": ["tasks", "batches"],
  "title": "Repokit Task Configuration",
  "type": "object"
}
