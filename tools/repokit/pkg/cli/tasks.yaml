# yaml-language-server: $schema=../../../eslint/schemas/tasks.schema.json
vars:
  root_dir: .
  repo_dir: tools/repokit
  repo_bin: tools/repokit/dist/repokit
  pnpm: pnpm exec
  go: go

tasks:
  # --- Atomic Tasks ---
  lint_eslint:
    name: ESLint
    type: single
    pre_msg: Analyzing frontend code quality...
    on_error: ESLint found issues in the codebase.
    command: ${pnpm} eslint .

  build_go:
    name: Go Build
    type: single
    pre_msg: Compiling Repokit orchestrator...
    on_error: Failed to build Go binary.
    command: ${go} build -o ../../${repo_bin} ./main.go
    cwd: ${repo_dir}

  # --- Unified Batch Pipelines ---
  lint:
    name: Linting Pipeline
    type: batch
    pre_msg: Starting full project linting pass...
    on_error: One or more linters failed.
    tasks: [lint_eslint]
    parallel: true

  setup:
    name: Project Setup
    type: batch
    pre_msg: Orchestrating hybrid environment setup...
    on_error: Environment setup failed.
    tasks: [build_go]
    parallel: false
